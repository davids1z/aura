import{a as ee,b as G}from"./chunk-AULBO7WE.js";import{e as Q,h as X}from"./chunk-STA56OFL.js";import{a as L,b as $,c as ne,d as ie,e as Y,f as oe,g as ae,h as re,i as B,p as se,q as le,r as ce,s as de,t as pe,u as j}from"./chunk-ZP7S7QXW.js";import"./chunk-B3VCS4FI.js";import{b as F}from"./chunk-76MEHGP2.js";import{Fa as T,Fc as A,Gc as N,Hc as W,Jb as V,Jc as te,Qa as h,Ra as _,Sa as H,Ta as R,Tb as J,Ua as z,V as x,Va as g,Wa as o,Xa as a,Xb as I,Ya as O,Z as u,_ as m,ab as v,cb as f,db as c,ea as k,ia as E,pb as Z,qa as q,rb as r,sb as d,ta as n,tb as M,ub as U,vb as K,wb as w,xb as P,yb as y}from"./chunk-WPYW3ACR.js";function _e(l,i){if(l&1&&(o(0,"div",10),r(1),a()),l&2){let e=c(2);n(),d(e.error)}}function Ce(l,i){if(l&1){let e=v();o(0,"div",3)(1,"div",4)(2,"h2"),r(3),a(),o(4,"p"),r(5),a()(),o(6,"form",5),f("ngSubmit",function(){u(e);let t=c();return m(t.login())}),o(7,"input",6),y("ngModelChange",function(t){u(e);let p=c();return P(p.loginEmail,t)||(p.loginEmail=t),m(t)}),a(),o(8,"div",7)(9,"input",8),y("ngModelChange",function(t){u(e);let p=c();return P(p.loginPassword,t)||(p.loginPassword=t),m(t)}),a(),o(10,"button",9),f("mousedown",function(t){return u(e),m(t.preventDefault())})("click",function(){u(e);let t=c();return m(t.showLoginPassword=!t.showLoginPassword)}),o(11,"mat-icon"),r(12),a()()(),h(13,_e,2,1,"div",10),o(14,"button",11),r(15),a()(),o(16,"div",12)(17,"p"),r(18),a(),o(19,"button",13),f("click",function(){u(e);let t=c();return m(t.mode="register")}),r(20),a()()()}if(l&2){let e=c();n(3),d(e.i18n.t().auth.loginTitle),n(2),d(e.i18n.t().auth.loginSubtitle),n(2),w("ngModel",e.loginEmail),g("placeholder",e.i18n.t().auth.email),n(2),g("type",e.showLoginPassword?"text":"password"),w("ngModel",e.loginPassword),g("placeholder",e.i18n.t().auth.password),n(3),d(e.showLoginPassword?"visibility":"visibility_off"),n(),_(e.error?13:-1),n(),g("disabled",e.loading),n(),M(" ",e.loading?e.i18n.t().auth.loggingIn:e.i18n.t().auth.login," "),n(3),d(e.i18n.t().auth.noAccount),n(2),d(e.i18n.t().auth.register)}}function be(l,i){if(l&1&&(o(0,"div",10),r(1),a()),l&2){let e=c(2);n(),d(e.error)}}function ve(l,i){if(l&1){let e=v();o(0,"div",3)(1,"div",4)(2,"h2"),r(3),a(),o(4,"p"),r(5),a()(),o(6,"form",5),f("ngSubmit",function(){u(e);let t=c();return m(t.register())}),o(7,"input",14),y("ngModelChange",function(t){u(e);let p=c();return P(p.regName,t)||(p.regName=t),m(t)}),a(),o(8,"input",6),y("ngModelChange",function(t){u(e);let p=c();return P(p.regEmail,t)||(p.regEmail=t),m(t)}),a(),o(9,"input",15),y("ngModelChange",function(t){u(e);let p=c();return P(p.regPhone,t)||(p.regPhone=t),m(t)}),a(),o(10,"div",7)(11,"input",16),y("ngModelChange",function(t){u(e);let p=c();return P(p.regPassword,t)||(p.regPassword=t),m(t)}),a(),o(12,"button",9),f("mousedown",function(t){return u(e),m(t.preventDefault())})("click",function(){u(e);let t=c();return m(t.showRegPassword=!t.showRegPassword)}),o(13,"mat-icon"),r(14),a()()(),h(15,be,2,1,"div",10),o(16,"button",11),r(17),a()(),o(18,"div",12)(19,"p"),r(20),a(),o(21,"button",13),f("click",function(){u(e);let t=c();return m(t.mode="login")}),r(22),a()()()}if(l&2){let e=c();n(3),d(e.i18n.t().auth.registerTitle),n(2),d(e.i18n.t().auth.registerSubtitle),n(2),w("ngModel",e.regName),g("placeholder",e.i18n.t().auth.name),n(),w("ngModel",e.regEmail),g("placeholder",e.i18n.t().auth.email),n(),w("ngModel",e.regPhone),g("placeholder",e.i18n.t().auth.phone),n(2),g("type",e.showRegPassword?"text":"password"),w("ngModel",e.regPassword),g("placeholder",e.i18n.t().auth.passwordHint),n(3),d(e.showRegPassword?"visibility":"visibility_off"),n(),_(e.error?15:-1),n(),g("disabled",e.loading),n(),M(" ",e.loading?e.i18n.t().auth.registering:e.i18n.t().auth.register," "),n(3),d(e.i18n.t().auth.hasAccount),n(2),d(e.i18n.t().auth.login)}}var D=class l{authService=x(G);dialogRef=x(de);cdr=x(V);ngZone=x(k);i18n=x(W);constructor(){E(()=>{this.i18n.language(),this.cdr.detectChanges()})}mode="register";error="";loading=!1;showLoginPassword=!1;showRegPassword=!1;loginEmail="";loginPassword="";regName="";regEmail="";regPhone="";regPassword="";close(){this.dialogRef.close(!1)}login(){if(!this.loginEmail||!this.loginPassword){this.error=this.i18n.t().auth.fillAllFields,this.cdr.detectChanges();return}this.loading=!0,this.error="",this.cdr.detectChanges(),this.authService.login(this.loginEmail,this.loginPassword).subscribe({next:()=>{this.ngZone.run(()=>{this.loading=!1,this.cdr.detectChanges(),this.dialogRef.close(!0)})},error:i=>{this.ngZone.run(()=>{this.loading=!1,this.error=i.error?.error||this.i18n.t().auth.loginError,this.cdr.detectChanges()})}})}register(){if(!this.regName||!this.regEmail||!this.regPhone||!this.regPassword){this.error=this.i18n.t().auth.fillAllFields,this.cdr.detectChanges();return}if(this.regPassword.length<6){this.error=this.i18n.t().auth.passwordTooShort,this.cdr.detectChanges();return}this.loading=!0,this.error="",this.cdr.detectChanges(),this.authService.register({name:this.regName,email:this.regEmail,phone:this.regPhone,password:this.regPassword}).subscribe({next:()=>{this.ngZone.run(()=>{this.loading=!1,this.cdr.detectChanges(),this.dialogRef.close(!0)})},error:i=>{this.ngZone.run(()=>{this.loading=!1,this.error=i.error?.error||this.i18n.t().auth.registerError,this.cdr.detectChanges()})}})}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=T({type:l,selectors:[["app-auth-dialog"]],decls:7,vars:2,consts:[[1,"auth-dialog"],[1,"dialog-header"],[1,"back-btn",3,"click"],[1,"form-container"],[1,"form-title"],[1,"auth-form",3,"ngSubmit"],["type","email","name","email","required","",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"password-field"],["name","password","required","",1,"form-input",3,"ngModelChange","type","ngModel","placeholder"],["type","button",1,"eye-btn",3,"mousedown","click"],[1,"error-message"],["type","submit",1,"submit-btn",3,"disabled"],[1,"switch-mode"],[3,"click"],["type","text","name","name","required","",1,"form-input",3,"ngModelChange","ngModel","placeholder"],["type","tel","name","phone","required","",1,"form-input",3,"ngModelChange","ngModel","placeholder"],["name","password","required","","minlength","6",1,"form-input",3,"ngModelChange","type","ngModel","placeholder"]],template:function(e,s){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),f("click",function(){return s.close()}),o(3,"mat-icon"),r(4,"arrow_back"),a()()(),h(5,Ce,21,13,"div",3),h(6,ve,23,17,"div",3),a()),e&2&&(n(5),_(s.mode==="login"?5:-1),n(),_(s.mode==="register"?6:-1))},dependencies:[I,B,oe,L,$,ne,ae,re,Y,ie,F,N,A,j,ee],styles:[".auth-dialog[_ngcontent-%COMP%]{background:#0f0f0ff2;min-height:100vh;min-height:100dvh;padding:clamp(12px,4vw,20px);padding-bottom:env(safe-area-inset-bottom,20px);overflow-y:auto;-webkit-overflow-scrolling:touch;touch-action:pan-y}.dialog-header[_ngcontent-%COMP%]{margin-bottom:clamp(16px,6vw,32px)}.back-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#ffffff0d;border:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:center;color:#ffffff80;cursor:pointer}.form-container[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.form-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:clamp(20px,6vw,32px)}.form-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:clamp(16px,5vw,20px);font-weight:300;text-transform:uppercase;letter-spacing:.3em;color:#ffffffe6;margin-bottom:8px}.form-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:#ffffff4d}.auth-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.form-input[_ngcontent-%COMP%]{width:100%;padding:clamp(12px,4vw,16px) clamp(14px,4.5vw,20px);background:#ffffff08;border:1px solid rgba(255,255,255,.06);border-radius:12px;font-size:clamp(13px,3.8vw,14px);color:#ffffffe6;outline:none;font-family:inherit}.form-input[_ngcontent-%COMP%]::placeholder{color:#fff3}.form-input[_ngcontent-%COMP%]:focus{border-color:#c9a96e4d;box-shadow:0 0 0 2px #c9a96e1a}.password-field[_ngcontent-%COMP%]{position:relative}.password-field[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding-right:48px}.password-field[_ngcontent-%COMP%]   .eye-btn[_ngcontent-%COMP%]{position:absolute;right:8px;top:50%;transform:translateY(-50%);width:36px;height:36px;border-radius:50%;background:transparent;border:none;display:flex;align-items:center;justify-content:center;color:#ffffff4d;cursor:pointer}.password-field[_ngcontent-%COMP%]   .eye-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.password-field[_ngcontent-%COMP%]   .eye-btn[_ngcontent-%COMP%]:active{color:#c9a96e}.error-message[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid rgba(239,68,68,.15);color:#fca5a5;padding:12px 16px;border-radius:12px;font-size:13px;text-align:center}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:clamp(14px,4.5vw,18px);background:linear-gradient(135deg,#c9a96e,#dfc598);color:#0a0a0a;border:none;border-radius:12px;font-size:clamp(9px,2.8vw,10px);font-weight:500;text-transform:uppercase;letter-spacing:.3em;cursor:pointer;margin-top:8px;box-shadow:0 8px 24px #c9a96e33}.submit-btn[_ngcontent-%COMP%]:disabled{background:#ffffff0f;color:#ffffff40;cursor:not-allowed;box-shadow:none}.submit-btn[_ngcontent-%COMP%]:active:not(:disabled){box-shadow:0 12px 30px #c9a96e59}.switch-mode[_ngcontent-%COMP%]{text-align:center;margin-top:clamp(20px,6vw,32px);padding-top:clamp(16px,5vw,24px);border-top:1px solid rgba(255,255,255,.06)}.switch-mode[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;color:#ffffff4d;margin-bottom:8px}.switch-mode[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:12px;color:#c9a96e;font-weight:500;cursor:pointer}@media(min-width:768px){.auth-dialog[_ngcontent-%COMP%]{min-height:auto;padding:40px;display:flex;flex-direction:column;align-items:center}.dialog-header[_ngcontent-%COMP%]{width:100%;max-width:400px}.form-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 14px 40px #c9a96e59}}"]})};var Me=(l,i)=>i.dateStr,we=(l,i)=>i.time;function Pe(l,i){if(l&1){let e=v();o(0,"div",5)(1,"div",38)(2,"div",39),r(3),a(),o(4,"span"),r(5),a()(),o(6,"button",40),f("click",function(){u(e);let t=c(2);return m(t.logout())}),o(7,"mat-icon"),r(8,"logout"),a()()()}if(l&2){let e=c(2);g("revealDelay",180),n(3),d(e.authService.currentUser.name.charAt(0)),n(2),d(e.authService.currentUser.name)}}function ye(l,i){if(l&1&&(o(0,"span"),r(1),a()),l&2){let e=i.$implicit;n(),d(e)}}function Oe(l,i){if(l&1){let e=v();o(0,"button",41),f("click",function(){let t=u(e).$implicit,p=c(2);return m(p.selectDate(t))}),r(1),a()}if(l&2){let e=i.$implicit;Z("available",e.status==="available")("limited",e.status==="limited")("full",e.status==="full")("closed",e.status==="closed")("past",e.status==="past")("disabled",e.status==="disabled")("today",e.isToday)("selected",e.isSelected),g("disabled",e.status==="disabled"||e.status==="past"||e.status==="closed"||e.status==="full"),n(),M(" ",e.day||""," ")}}function Se(l,i){if(l&1&&(o(0,"div",20),r(1),a()),l&2){let e=c(2);n(),M(" ",e.formatSelectedDate()," ")}}function De(l,i){if(l&1&&(o(0,"div",22)(1,"mat-icon",42),r(2,"sync"),a(),o(3,"p"),r(4),a(),o(5,"p",43),r(6),a()()),l&2){let e=c(2);n(4),d(e.i18n.t().reservation.loading),n(2),d(e.i18n.t().reservation.pleaseWait)}}function ke(l,i){if(l&1){let e=v();o(0,"div",23)(1,"mat-icon"),r(2,"cloud_off"),a(),o(3,"p"),r(4),a(),o(5,"button",44),f("click",function(){u(e);let t=c(2);return m(t.loadSlots(t.selectedDate))}),o(6,"mat-icon"),r(7,"refresh"),a(),r(8),a()()}if(l&2){let e=c(2);n(4),d(e.i18n.t().reservation.error),n(4),M(" ",e.i18n.t().reservation.retry," ")}}function Ee(l,i){if(l&1&&(o(0,"div",24)(1,"p",45),r(2),a(),o(3,"p",46),r(4),a()()),l&2){let e=c(2);n(2),d(e.i18n.t().reservation.closed),n(2),d(e.closedReason||e.i18n.t().reservation.closedDefault)}}function Te(l,i){if(l&1){let e=v();o(0,"button",50),f("click",function(){let t=u(e).$implicit,p=c(3);return m(p.selectSlot(t.time))}),o(1,"span",51),r(2),a(),o(3,"span",52),r(4),a()()}if(l&2){let e=i.$implicit,s=c(3);Z("available",e.available>0)("full",e.available<=0)("selected",s.selectedSlot===e.time),g("disabled",e.available<=0),n(2),d(e.time),n(2),d(e.available>0?s.i18n.t().reservation.slotAvailable:s.i18n.t().reservation.slotFull)}}function Re(l,i){if(l&1&&(o(0,"p",49),r(1),a()),l&2){let e=c(3);n(),K("",e.i18n.t().reservation.workingHours,": ",e.schedule.openTime," - ",e.schedule.closeTime)}}function ze(l,i){if(l&1&&(o(0,"div",47),R(1,Te,5,9,"button",48,we),a(),h(3,Re,2,3,"p",49)),l&2){let e=c(2);n(),z(e.slots),n(2),_(e.schedule?3:-1)}}function Ve(l,i){if(l&1){let e=v();o(0,"header",2)(1,"h1"),r(2,"Aura"),a(),O(3,"div",3),o(4,"p",4),r(5),a()(),h(6,Pe,9,3,"div",5),o(7,"section",6)(8,"label"),r(9),a(),o(10,"div",7)(11,"button",8),f("click",function(){u(e);let t=c();return m(t.prevMonth())}),o(12,"mat-icon"),r(13,"chevron_left"),a()(),o(14,"span",9),r(15),a(),o(16,"button",8),f("click",function(){u(e);let t=c();return m(t.nextMonth())}),o(17,"mat-icon"),r(18,"chevron_right"),a()()(),o(19,"div",10)(20,"div",11),R(21,ye,2,1,"span",null,H),a(),o(23,"div",12),R(24,Oe,2,18,"button",13,Me),a()(),o(26,"div",14)(27,"div",15),O(28,"span",16),r(29),a(),o(30,"div",15),O(31,"span",17),r(32),a(),o(33,"div",15),O(34,"span",18),r(35),a(),o(36,"div",15),O(37,"span",19),r(38),a()(),h(39,Se,2,1,"div",20),a(),o(40,"section",21)(41,"label"),r(42),a(),h(43,De,7,2,"div",22),h(44,ke,9,2,"div",23),h(45,Ee,5,2,"div",24),h(46,ze,4,1),a(),o(47,"section",25)(48,"label"),r(49),a(),o(50,"div",26)(51,"button",27),f("click",function(){u(e);let t=c();return m(t.updateGuests(-1))}),r(52,"\u2212"),a(),o(53,"span",28),r(54),a(),o(55,"button",27),f("click",function(){u(e);let t=c();return m(t.updateGuests(1))}),r(56,"+"),a()()(),o(57,"section",29)(58,"label"),r(59),a(),o(60,"textarea",30),y("ngModelChange",function(t){u(e);let p=c();return P(p.notes,t)||(p.notes=t),m(t)}),a()(),o(61,"section",31)(62,"div",32)(63,"div")(64,"p",33),r(65),a(),o(66,"p",34),r(67,"95,00 \u20AC"),a()(),o(68,"div",35)(69,"p",33),r(70),a(),o(71,"p",36),r(72),a()()()(),o(73,"button",37),f("click",function(){u(e);let t=c();return m(t.submitReservation())}),r(74),a()}if(l&2){let e=c();g("revealDelay",50),n(5),d(e.i18n.t().home.season),n(),_(e.authService.currentUser?6:-1),n(),g("revealDelay",300),n(2),d(e.i18n.t().reservation.selectDate),n(2),g("disabled",!e.canGoPrev),n(4),U("",e.i18n.t().reservation.monthNames[e.currentMonth]," ",e.currentYear),n(),g("disabled",!e.canGoNext),n(5),z(e.i18n.t().reservation.weekdays),n(3),z(e.calendarDays),n(5),d(e.i18n.t().reservation.available),n(3),d(e.i18n.t().reservation.limited),n(3),d(e.i18n.t().reservation.full),n(3),d(e.i18n.t().reservation.closed),n(),_(e.selectedDate?39:-1),n(),g("revealDelay",80),n(2),d(e.i18n.t().reservation.selectTime),n(),_(e.loadingSlots?43:-1),n(),_(e.slotsError&&!e.loadingSlots?44:-1),n(),_(e.isClosed&&!e.loadingSlots?45:-1),n(),_(!e.loadingSlots&&!e.isClosed&&e.slots.length>0?46:-1),n(),g("revealDelay",80),n(2),d(e.i18n.t().reservation.guests),n(2),g("disabled",e.guests<=1),n(3),d(e.guests),n(),g("disabled",e.guests>=8),n(2),g("revealDelay",80),n(2),d(e.i18n.t().reservation.specialRequests),n(),w("ngModel",e.notes),g("placeholder",e.i18n.t().checkout.noteHint),n(),g("revealDelay",100),n(4),d(e.i18n.t().reservation.pricePerPersonLabel),n(5),d(e.i18n.t().reservation.total),n(2),M("",(e.guests*95).toFixed(2).replace(".",",")," \u20AC"),n(),g("revealDelay",150)("disabled",!e.canSubmit||e.loading),n(),M(" ",e.loading?e.i18n.t().reservation.sending:e.canSubmit?e.i18n.t().reservation.confirmReservation:e.i18n.t().reservation.selectSlot," ")}}function Ie(l,i){if(l&1&&(o(0,"div",1),O(1,"div",53),o(2,"h2"),r(3),a(),O(4,"div",54),o(5,"button",55),r(6),a()()),l&2){let e=c();n(3),d(e.i18n.t().reservation.successTitle),n(),g("innerHTML",e.successMessage,q),n(2),d(e.i18n.t().reservation.backToHome)}}var ge=class l{apiService=x(ce);authService=x(G);dialog=x(pe);snackBar=x(se);cdr=x(V);ngZone=x(k);location=x(J);i18n=x(W);constructor(){E(()=>{this.i18n.language(),this.success&&this.selectedDate&&this.selectedSlot&&this.buildSuccessMessage(),this.cdr.detectChanges()})}currentMonth=new Date().getMonth();currentYear=new Date().getFullYear();calendarDays=[];today=new Date;maxDate=new Date(2026,11,31);selectedDate=null;selectedSlot=null;slots=[];loadingSlots=!1;slotsError=!1;isClosed=!1;closedReason="";schedule=null;guests=2;notes="";loading=!1;success=!1;successMessage="";get canGoPrev(){return this.currentYear>this.today.getFullYear()||this.currentYear===this.today.getFullYear()&&this.currentMonth>this.today.getMonth()}get canGoNext(){return this.currentYear<2026||this.currentYear===2026&&this.currentMonth<11}get canSubmit(){return!!this.selectedDate&&!!this.selectedSlot}ngOnInit(){this.today.setHours(0,0,0,0),this.buildCalendar();let i=this.formatDate(this.today);this.selectedDate=i,this.authService.currentUser?(this.loadSlots(i),setTimeout(()=>this.loadMonthAvailability(),2e3)):this.showAuthDialog()}showAuthDialog(){let i=window.innerWidth<768;this.dialog.open(D,{maxWidth:i?"100vw":"480px",maxHeight:i?"100vh":"90vh",width:i?"100%":"480px",height:i?"100%":"auto",panelClass:i?"fullscreen-dialog":"",disableClose:!1}).afterClosed().subscribe(e=>{if(e===!0){let s=this.formatDate(this.today);this.selectedDate=s,this.loadSlots(s),setTimeout(()=>this.loadMonthAvailability(),2e3)}else this.location.back();this.cdr.detectChanges()})}prevMonth(){this.canGoPrev&&(this.currentMonth--,this.currentMonth<0&&(this.currentMonth=11,this.currentYear--),this.buildCalendar(),this.loadMonthAvailability())}nextMonth(){this.canGoNext&&(this.currentMonth++,this.currentMonth>11&&(this.currentMonth=0,this.currentYear++),this.buildCalendar(),this.loadMonthAvailability())}buildCalendar(){this.calendarDays=[];let e=new Date(this.currentYear,this.currentMonth,1).getDay()-1;e<0&&(e=6);let s=new Date(this.currentYear,this.currentMonth+1,0).getDate();for(let t=0;t<e;t++)this.calendarDays.push({date:new Date,day:0,dateStr:"",status:"disabled",isToday:!1,isSelected:!1});for(let t=1;t<=s;t++){let p=new Date(this.currentYear,this.currentMonth,t),C=this.formatDate(p),b=p<this.today,S=p.toDateString()===this.today.toDateString();this.calendarDays.push({date:p,day:t,dateStr:C,status:b?"past":"available",isToday:S,isSelected:this.selectedDate===C})}}loadMonthAvailability(){let i=new Date(this.currentYear,this.currentMonth,1),e=new Date(this.currentYear,this.currentMonth+1,0),s=this.formatDate(i),t=this.formatDate(e);this.apiService.getCalendarStatus(s,t).subscribe({next:p=>{this.ngZone.run(()=>{!p||p.length===0||(p.forEach(C=>{let b=this.calendarDays.find(S=>S.dateStr===C.date);!b||b.status==="disabled"||b.status==="past"||(C.isClosed?b.status="closed":C.availableSlots===0?b.status="full":C.availableSlots<C.totalSlots/2?b.status="limited":b.status="available")}),this.cdr.detectChanges())})},error:()=>{}})}selectDate(i){i.status==="disabled"||i.status==="past"||i.status==="closed"||i.status==="full"||(this.calendarDays.forEach(e=>e.isSelected=!1),i.isSelected=!0,this.selectedDate=i.dateStr,this.selectedSlot=null,this.loadSlots(i.dateStr))}loadSlots(i){this.loadingSlots=!0,this.slotsError=!1,this.isClosed=!1,this.slots=[],this.cdr.detectChanges(),this.apiService.getAvailableSlots(i).subscribe({next:e=>{this.ngZone.run(()=>{this.loadingSlots=!1,this.slotsError=!1,this.schedule=e,e.isClosed?(this.isClosed=!0,this.closedReason=e.reason||""):this.slots=e.allSlots||e.slots||[],this.cdr.detectChanges()})},error:()=>{this.ngZone.run(()=>{this.loadingSlots=!1,this.slotsError=!0,this.cdr.detectChanges()})}})}selectSlot(i){this.selectedSlot=i}updateGuests(i){let e=this.guests+i;e>=1&&e<=8&&(this.guests=e)}formatDate(i){let e=i.getFullYear(),s=String(i.getMonth()+1).padStart(2,"0"),t=String(i.getDate()).padStart(2,"0");return`${e}-${s}-${t}`}formatSelectedDate(){if(!this.selectedDate)return"";let i=this.i18n.t().reservation,e=new Date(this.selectedDate+"T12:00:00"),s=i.dayNames[e.getDay()],t=e.getDate(),p=i.monthNamesGenitive[e.getMonth()],C=e.getFullYear();return`${s}, ${t}. ${p} ${C}`}logout(){this.authService.logout().subscribe()}submitReservation(){if(!this.authService.currentUser){let e=window.innerWidth<768;this.dialog.open(D,{maxWidth:e?"100vw":"480px",maxHeight:e?"100vh":"90vh",width:e?"100%":"480px",height:e?"100%":"auto",panelClass:e?"fullscreen-dialog":""}).afterClosed().subscribe(s=>{s&&this.submitReservation()});return}if(!this.selectedDate||!this.selectedSlot)return;this.loading=!0;let i={date:this.selectedDate,time:this.selectedSlot,guests:this.guests,specialRequests:this.notes||void 0};this.apiService.createReservation(i).subscribe({next:()=>{this.loading=!1,this.success=!0,this.buildSuccessMessage()},error:e=>{this.loading=!1,this.snackBar.open(e.error?.error||this.i18n.t().reservation.reservationError,"OK",{duration:3e3})}})}buildSuccessMessage(){if(!this.selectedDate||!this.selectedSlot)return;let i=this.i18n.t().reservation,e=new Date(this.selectedDate+"T12:00:00"),s=i.dayNames[e.getDay()],t=e.getDate(),p=i.monthNamesGenitive[e.getMonth()],C=e.getFullYear(),b=(this.guests*95).toFixed(2).replace(".",","),S=this.guests===1?i.person1:this.guests<5?i.person24:i.person5plus,ue=this.formatTime(this.selectedSlot);this.successMessage=`
      ${i.successFor} <b>${this.guests} ${S}</b> ${i.successReceived}<br><br>
      <span style="color:rgba(255,255,255,0.3);text-transform:uppercase;letter-spacing:0.2em;font-size:10px">${i.dateLabel}</span><br>
      <b>${s}, ${t}. ${p} ${C}</b><br><br>
      <span style="color:rgba(255,255,255,0.3);text-transform:uppercase;letter-spacing:0.2em;font-size:10px">${i.timeLabel}</span><br>
      <b>${ue}</b><br><br>
      <span style="color:rgba(255,255,255,0.3);text-transform:uppercase;letter-spacing:0.2em;font-size:10px">${i.totalAmountLabel}</span><br>
      <span style="font-size:16px;color:#c9a96e">${b} \u20AC</span><br><br>
      <span style="color:rgba(255,255,255,0.3);font-size:9px">${i.confirmSentTo} ${this.authService.currentUser?.email}</span>
    `}formatTime(i){if(this.i18n.language()!=="en")return i;let[e,s]=i.split(":"),t=parseInt(e,10);return t===0?`12:${s} AM`:t<12?`${t}:${s} AM`:t===12?`12:${s} PM`:`${t-12}:${s} PM`}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=T({type:l,selectors:[["app-reservation"]],decls:3,vars:2,consts:[[1,"reservation-page"],[1,"success-screen"],["appReveal","",1,"res-header",3,"revealDelay"],[1,"divider"],[1,"season"],["appReveal","",1,"user-bar",3,"revealDelay"],["appReveal","",1,"calendar-section",3,"revealDelay"],[1,"calendar-nav"],[1,"nav-btn",3,"click","disabled"],[1,"month-label"],[1,"calendar-grid"],[1,"weekday-header"],[1,"days-grid"],[1,"cal-day",3,"available","limited","full","closed","past","disabled","today","selected"],[1,"legend"],[1,"legend-item"],[1,"dot","available"],[1,"dot","limited"],[1,"dot","full"],[1,"dot","closed"],[1,"selected-date-display"],["appReveal","",1,"slots-section",3,"revealDelay"],[1,"loading-slots"],[1,"error-slots"],[1,"closed-message"],["appReveal","",1,"guests-section",3,"revealDelay"],[1,"guest-counter"],[1,"counter-btn",3,"click","disabled"],[1,"guest-count"],["appReveal","",1,"notes-section",3,"revealDelay"],[3,"ngModelChange","ngModel","placeholder"],["appReveal","",1,"price-section",3,"revealDelay"],[1,"price-row"],[1,"price-label"],[1,"price-value"],[1,"price-total"],[1,"total-value"],["appReveal","",1,"submit-btn",3,"click","revealDelay","disabled"],[1,"user-info"],[1,"user-avatar"],[1,"logout-btn",3,"click"],[1,"cal-day",3,"click","disabled"],[1,"spin"],[1,"loading-hint"],[1,"retry-btn",3,"click"],[1,"closed-title"],[1,"closed-reason"],[1,"slots-grid"],[1,"slot-btn",3,"available","full","selected","disabled"],[1,"working-hours"],[1,"slot-btn",3,"click","disabled"],[1,"slot-time"],[1,"slot-status"],[1,"success-divider"],[1,"success-summary",3,"innerHTML"],["routerLink","/home",1,"back-btn"]],template:function(e,s){e&1&&(o(0,"div",0),h(1,Ve,75,36),h(2,Ie,7,3,"div",1),a()),e&2&&(n(),_(s.authService.currentUser&&!s.success?1:-1),n(),_(s.authService.currentUser&&s.success?2:-1))},dependencies:[I,B,L,$,Y,F,N,A,j,le,te,X,Q],styles:["[_nghost-%COMP%]{display:block;overflow:hidden;background:#0a0a0a}.reservation-page[_ngcontent-%COMP%]{background:#0f0f0f99;border:1px solid rgba(255,255,255,.06);min-height:100vh;padding:clamp(20px,6vw,32px) clamp(16px,5vw,24px) 120px;border-radius:clamp(20px,6vw,32px);margin:clamp(8px,2.5vw,16px);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);overflow:hidden}.res-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px}.res-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:clamp(22px,6vw,28px);font-weight:300;letter-spacing:.4em;text-transform:uppercase;color:#ffffffe6}.res-header[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:60px;height:1px;background:linear-gradient(to right,transparent,rgba(201,169,110,.5),transparent);margin:16px auto}.res-header[_ngcontent-%COMP%]   .season[_ngcontent-%COMP%]{font-size:10px;text-transform:uppercase;letter-spacing:.2em;color:#c9a96e;font-style:italic}.user-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:#ffffff08;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.06);padding:8px 12px 8px 16px;border-radius:50px;margin-bottom:24px}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.user-avatar[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background:#c9a96e26;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:600;color:#c9a96e}.user-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;color:#ffffff80;font-weight:500}.logout-btn[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background:transparent;border:none;display:flex;align-items:center;justify-content:center;color:#ffffff4d;cursor:pointer}.logout-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}section[_ngcontent-%COMP%]{margin-bottom:24px}label[_ngcontent-%COMP%]{display:block;font-size:9px;text-transform:uppercase;letter-spacing:.2em;color:#c9a96e;margin-bottom:12px}.calendar-nav[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.nav-btn[_ngcontent-%COMP%]{width:36px;height:36px;border:none;background:transparent;color:#ffffff4d;cursor:pointer;display:flex;align-items:center;justify-content:center}.nav-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.month-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#ffffffe6}.calendar-grid[_ngcontent-%COMP%]{background:#ffffff08;border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:clamp(8px,3vw,16px)}.weekday-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:8px}.weekday-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center;font-size:10px;color:#ffffff4d;font-weight:500;padding:8px 0}.days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:clamp(2px,.8vw,4px)}.cal-day[_ngcontent-%COMP%]{aspect-ratio:1;border:none;border-radius:clamp(6px,2vw,10px);font-size:clamp(11px,3.2vw,13px);font-weight:500;cursor:pointer;transition:all .2s ease}.cal-day.available[_ngcontent-%COMP%]{background:#10b98126;color:#6ee7b7}.cal-day.limited[_ngcontent-%COMP%]{background:#f59e0b26;color:#fbbf24}.cal-day.full[_ngcontent-%COMP%]{background:#ef444426;color:#fca5a5;cursor:not-allowed}.cal-day.closed[_ngcontent-%COMP%]{background:#ffffff0d;color:#ffffff4d;text-decoration:line-through;cursor:not-allowed}.cal-day.past[_ngcontent-%COMP%], .cal-day.disabled[_ngcontent-%COMP%]{background:transparent;color:#ffffff26;cursor:not-allowed}.cal-day.today[_ngcontent-%COMP%]:not(.selected){outline:2px solid #c9a96e;outline-offset:-2px}.cal-day.selected[_ngcontent-%COMP%]{background:#c9a96e!important;color:#0a0a0a!important;font-weight:700}.legend[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin-top:16px}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:9px;color:#fff6}.dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:4px}.dot.available[_ngcontent-%COMP%]{background:#10b98126}.dot.limited[_ngcontent-%COMP%]{background:#f59e0b26}.dot.full[_ngcontent-%COMP%]{background:#ef444426}.dot.closed[_ngcontent-%COMP%]{background:#ffffff0d}.selected-date-display[_ngcontent-%COMP%]{background:#c9a96e;color:#0a0a0a;text-align:center;padding:14px;border-radius:12px;margin-top:16px;font-size:13px;font-weight:500}.loading-slots[_ngcontent-%COMP%], .closed-message[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#ffffff4d}.loading-slots[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .closed-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.loading-slots[_ngcontent-%COMP%]   .spin[_ngcontent-%COMP%], .closed-message[_ngcontent-%COMP%]   .spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-slots[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .closed-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:8px;font-size:13px}.loading-slots[_ngcontent-%COMP%]   .loading-hint[_ngcontent-%COMP%], .closed-message[_ngcontent-%COMP%]   .loading-hint[_ngcontent-%COMP%]{font-size:11px;color:#fff3}.error-slots[_ngcontent-%COMP%]{text-align:center;padding:24px;background:#ffffff08;border:1px solid rgba(255,255,255,.06);border-radius:16px;color:#ffffff4d}.error-slots[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#fff3}.error-slots[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:12px;font-size:13px}.error-slots[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{margin-top:12px;display:inline-flex;align-items:center;gap:6px;padding:10px 20px;background:#c9a96e;color:#0a0a0a;border:none;border-radius:50px;font-size:12px;cursor:pointer}.error-slots[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#0a0a0a}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.closed-message[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid rgba(239,68,68,.15);border-radius:16px}.closed-message[_ngcontent-%COMP%]   .closed-title[_ngcontent-%COMP%]{color:#fca5a5;font-weight:500;font-size:14px}.closed-message[_ngcontent-%COMP%]   .closed-reason[_ngcontent-%COMP%]{color:#fca5a5b3;font-size:12px}.slots-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.slot-btn[_ngcontent-%COMP%]{padding:14px 8px;border-radius:12px;border:1px solid rgba(255,255,255,.08);cursor:pointer;transition:all .2s ease;text-align:center;background:#ffffff05}.slot-btn[_ngcontent-%COMP%]   .slot-time[_ngcontent-%COMP%]{display:block;font-size:15px;font-weight:600;margin-bottom:4px}.slot-btn[_ngcontent-%COMP%]   .slot-status[_ngcontent-%COMP%]{display:block;font-size:10px;font-weight:400}.slot-btn.available[_ngcontent-%COMP%]{background:#10b9810f;border-color:#10b98133}.slot-btn.available[_ngcontent-%COMP%]   .slot-time[_ngcontent-%COMP%]{color:#6ee7b7}.slot-btn.available[_ngcontent-%COMP%]   .slot-status[_ngcontent-%COMP%]{color:#6ee7b780}.slot-btn.full[_ngcontent-%COMP%]{background:#ef44440f;border-color:#ef444426}.slot-btn.full[_ngcontent-%COMP%]   .slot-time[_ngcontent-%COMP%]{color:#fca5a5;text-decoration:line-through}.slot-btn.full[_ngcontent-%COMP%]   .slot-status[_ngcontent-%COMP%]{color:#fca5a580}.slot-btn.full[_ngcontent-%COMP%]{cursor:not-allowed}.slot-btn.selected[_ngcontent-%COMP%]{background:#c9a96e;border-color:#c9a96e;box-shadow:0 4px 16px #c9a96e4d}.slot-btn.selected[_ngcontent-%COMP%]   .slot-time[_ngcontent-%COMP%], .slot-btn.selected[_ngcontent-%COMP%]   .slot-status[_ngcontent-%COMP%]{color:#0a0a0a;text-decoration:none}.working-hours[_ngcontent-%COMP%]{text-align:center;font-size:11px;color:#ffffff40;margin-top:12px}.guest-counter[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:8px}.counter-btn[_ngcontent-%COMP%]{width:clamp(40px,12vw,48px);height:clamp(40px,12vw,48px);border:none;background:transparent;font-size:20px;color:#ffffff4d;cursor:pointer}.counter-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.counter-btn[_ngcontent-%COMP%]:active:not(:disabled){color:#c9a96e}.guest-count[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#ffffffe6}textarea[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:clamp(12px,3vw,16px);background:#ffffff08;border:1px solid rgba(255,255,255,.06);border-radius:16px;font-size:14px;color:#ffffffe6;resize:none;font-family:inherit;outline:none}textarea[_ngcontent-%COMP%]::placeholder{color:#fff3}textarea[_ngcontent-%COMP%]:focus{border-color:#c9a96e4d;box-shadow:0 0 0 2px #c9a96e1a}.price-section[_ngcontent-%COMP%]{padding-top:16px;border-top:1px solid rgba(255,255,255,.06)}.price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.price-label[_ngcontent-%COMP%]{font-size:9px;text-transform:uppercase;letter-spacing:.2em;color:#ffffff4d;margin-bottom:4px}.price-value[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#ffffff80}.price-total[_ngcontent-%COMP%]{text-align:right}.total-value[_ngcontent-%COMP%]{font-size:clamp(20px,6vw,24px);font-weight:300;color:#c9a96e}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:clamp(16px,4vw,20px);background:linear-gradient(135deg,#c9a96e,#dfc598);color:#0a0a0a;border:none;border-radius:16px;font-size:10px;font-weight:500;text-transform:uppercase;letter-spacing:.4em;cursor:pointer;box-shadow:0 10px 30px #c9a96e40;margin-top:8px}.submit-btn[_ngcontent-%COMP%]:active:not(:disabled){box-shadow:0 14px 40px #c9a96e66}.submit-btn[_ngcontent-%COMP%]:disabled{background:#ffffff0f;color:#ffffff40;cursor:not-allowed;box-shadow:none}.success-screen[_ngcontent-%COMP%]{text-align:center;padding:80px 24px}.success-screen[_ngcontent-%COMP%]   .success-divider[_ngcontent-%COMP%]{width:40px;height:1px;background:#c9a96e;margin:0 auto 40px}.success-screen[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:300;text-transform:uppercase;letter-spacing:.3em;color:#ffffffe6;margin-bottom:24px}.success-screen[_ngcontent-%COMP%]   .success-summary[_ngcontent-%COMP%]{font-size:12px;color:#ffffff80;line-height:2}.success-screen[_ngcontent-%COMP%]   .success-summary[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#ffffffe6}.success-screen[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{margin-top:48px;background:transparent;border:none;font-size:9px;text-transform:uppercase;letter-spacing:.2em;color:#ffffff4d;cursor:pointer;padding-bottom:4px;border-bottom:1px solid transparent}.success-screen[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{color:#c9a96e;border-bottom-color:#c9a96e}@media(orientation:landscape)and (max-height:500px){.reservation-page[_ngcontent-%COMP%]{padding:16px 24px 80px;border-radius:20px;max-width:600px;margin:8px auto}.res-header[_ngcontent-%COMP%]{margin-bottom:16px}.res-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px}.res-header[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin:10px auto}.user-bar[_ngcontent-%COMP%]{margin-bottom:16px}section[_ngcontent-%COMP%]{margin-bottom:16px}.calendar-grid[_ngcontent-%COMP%]{padding:12px}.cal-day[_ngcontent-%COMP%]{font-size:11px;border-radius:8px}.legend[_ngcontent-%COMP%]{margin-top:10px}.selected-date-display[_ngcontent-%COMP%]{padding:10px;margin-top:10px;font-size:12px}.slots-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr);gap:6px}.slot-btn[_ngcontent-%COMP%]{padding:10px 6px}.slot-btn[_ngcontent-%COMP%]   .slot-time[_ngcontent-%COMP%]{font-size:13px}.slot-btn[_ngcontent-%COMP%]   .slot-status[_ngcontent-%COMP%]{font-size:9px}.guest-counter[_ngcontent-%COMP%]{max-width:250px}.counter-btn[_ngcontent-%COMP%]{width:40px;height:40px}textarea[_ngcontent-%COMP%]{padding:12px;font-size:13px}.total-value[_ngcontent-%COMP%]{font-size:20px}.submit-btn[_ngcontent-%COMP%]{padding:16px;max-width:400px;margin-left:auto;margin-right:auto;display:block}.success-screen[_ngcontent-%COMP%]{padding:40px 24px}}@media(min-width:768px){.reservation-page[_ngcontent-%COMP%]{max-width:600px;margin:16px auto;padding:40px 40px 120px}.res-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:32px}.calendar-grid[_ngcontent-%COMP%]{padding:20px}.cal-day[_ngcontent-%COMP%]{font-size:14px}.slots-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}.slot-btn[_ngcontent-%COMP%]{padding:14px 10px}.guest-counter[_ngcontent-%COMP%]{max-width:300px}textarea[_ngcontent-%COMP%]{padding:18px}.total-value[_ngcontent-%COMP%]{font-size:28px}.submit-btn[_ngcontent-%COMP%]{max-width:400px;margin-left:auto;margin-right:auto;display:block;padding:22px}.success-screen[_ngcontent-%COMP%]{padding:100px 40px}}@media(min-width:1024px){.reservation-page[_ngcontent-%COMP%]{max-width:680px;padding:48px 48px 120px}.res-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:36px}.slots-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(5,1fr)}.cal-day[_ngcontent-%COMP%]{font-size:15px;border-radius:12px}}"]})};export{ge as ReservationComponent};
